{% extends "base.html" %}

{% load i18n %}
{% load l10n %}
{% load staticfiles %}

{% block path %}
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'home' %}">{% trans "Home" %}</a></li>
      <li class="breadcrumb-item" aria-current="page"><a href="{% url 'sports-manager:player-list' user.get_username %}">{% trans "My players" %}</a></li>
      <li class="breadcrumb-item" aria-current="page"><a href="{{ player.get_absolute_url }}">{{ player }}</a></li>
      <li class="breadcrumb-item active" aria-current="page">{% trans "Emergency contacts" %}</li>
    </ol>
  </nav>
{% endblock %}

{% block page_title %}
  {% blocktrans with full_name=player.full_name %}
    {{ full_name }}'s emergency contacts
  {% endblocktrans %}
{% endblock %}

{% block page_title_buttons %}
  {% if user.is_authenticated %}
    <div class="btn-group float-right" role="group">
      <a class="btn btn-primary" href="{% url 'sports-manager:player-emergency-contact-create' user.get_username player.slug %}">{% trans "New emergency contact" %}</a>
    </div>
  {% endif %}
{% endblock %}

{% block content %}
  {% for object in object_list %}
    {% if forloop.first %}
      <table class="table table-hover" id="myPlayerTable">
        <thead class="thead-light">
          <tr>
            <th scope="col">{% trans "First name" %}</th>
            <th scope="col">{% trans "Last name" %}</th>
            <th scope="col">{% trans "Phone number" %}</th>
            <th scope="col">{% trans "Email" %}</th>
            {% if user.is_authenticated and user == player.owner %}
              <th scope="col">{% trans "Links" %}</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
    {% endif %}

          <tr class="clickable-row" url="{{ object.get_absolute_url }}">
            <td>{{ object.first_name }}</td>
            <td>{{ object.last_name }}</td>
            <td>{{ object.phone|default:"&Oslash" }}</td>
            <td>{{ object.email|default:"&Oslash" }}</td>
            {% if user.is_authenticated and user == player.owner %}
              <td>
                <div class="btn-group btn-group-sm float-right" role="group">
                  <a class="btn btn-primary" href="{{ player.get_absolute_url }}">{% trans "Details" %}</a>
                  <a class="btn btn-primary" href="{% url 'sports-manager:player-update' player.owner.get_username player.slug %}">{% trans "Update" %}</a>
                  <a class="btn btn-danger" href="{% url 'sports-manager:player-delete' player.owner.get_username player.slug %}">{% trans "Delete" %}</a>
                </div>
              </td>
            {% endif %}
          </tr>

    {% if forloop.last %}
        </tbody>
      </table>
    {% endif %}
  {% empty %}
    <p>
      {% blocktrans with full_name=player.full_name %}
        No emergency contact linked to the player {{ full_name }} listed yet...
      {% endblocktrans %}
    </p>
  {% endfor %}
{% endblock %}

{% block javascript %}
  <script>
  $(".clickable-row").click(function() {
    window.location.href = $(this).attr("url")
  });
  </script>
{% endblock javascript %}